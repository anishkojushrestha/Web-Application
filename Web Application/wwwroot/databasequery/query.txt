CREATE TABLE CompanyInfo(
CompanyId bigint NOT NULL primary key,
CompanyName varchar(50),
Address varchar(50),
Email varchar(50),
PanNumber int,
City varchar(50),
Country varchar(50),
RegistrationDate date,
ValidFrom date,
ValidTo date,

)

CREATE TABLE ContactPerson(
ContactId bigint NOT NULL primary key,
ContactName varchar(50), 
Gender varchar(50),
Address varchar(50),
Email varchar(50),
PhoneNumber int,
MobileNumber int,
Designation varchar(50),
CompanyId bigint foreign key References CompanyInfo(CompanyId)

)

CREATE TABLE User(
UserId bigint NOT NULL primary key,
FirstName varchar(50),
LastName varchar(50),
UserName varchar(50),
Email varchar(50),
Password varchar(50),
Profile varchar(50),
IsActive bit,
CompanyId bigint foreign key References companyinfo(CompanyId)
)

CREATE TABLE Issue(
IssueId bigint NOT NULL primary key,
IssueNo int,
IssueDescription varchar(50),
IssueGeneratorSteps varchar(100),
CreatedDate Date,
AssignedDate Date,
Status varchar(50),
ResolveBy Date, 
DeletedBy Date, 
CloseBy Date, 

CompanyId bigint foreign key references CompanyInfo(CompanyId),
UserId bigint foreign key references users(UserId),
ContactId bigint foreign key references ContactPerson(ContactId)
)

Create TABLE IssueActivity(
IssueActivityId bigint NOT NULL primary key,
IssueDescription varchar(50),
IssueId bigint foreign key references Issue(IssueId),
)

Create TABLE Attachments(
AttachmentId bigint NOT NULL primary key,
AttachmentName varchar(200),

IssueId bigint foreign key references Issue(IssueId),
IssueActivityId bigint foreign key references IssueActivity(IssueActivityId)
)

Create TABLE IssueTransfer(
IssueTransferId bigint NOT NULL primary Key,
TransferedFrom varchar(50),
TransferedTo varchar(50),
TransferedDate date,
CurrentStage varchar(50),
IssueId bigint foreign key references Issue(IssueId)
)

Create TABLE IssueSupport(
IssueSupportId bigint NOT NULL primary key,
Status varchar(50),
AssignedDate Date,
IssueId bigint foreign key references Issue(IssueId),
UserId bigint foreign key references users(UserId),

)
Create Table EmailSetting(
EmailId varchar(50),
EmailPws varchar(50),
PORT varchar(50),
SMTP varchar(50)
)

Select i.*, U.UserName, c.CompanyName,p.ContactId, p.ContactName,p.Email as ContactEmail, p.PhoneNumber from Issue i left join users u on u.UserId = i.UserId join CompanyInfo c on c.CompanyId = i.CompanyId join ContactPerson p on p.ContactId = i.ContactId